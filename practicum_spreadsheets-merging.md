# Объединение данных из разных таблиц с помощью индексов

Предположим, мы хотим объединить две имеющиеся у нас таблицы в одну. Как это сделать? Сегодня мы разберем это на примере.

Например, мы имеем частотные списки слов в из двух корпусов, КРУТ и Русского учебного корпуса - частотные списки обрезаны по частоте 3. [(скачать таблицы)](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/%D0%9C%D0%B0%D1%82%D0%B5%D1%80%D0%B8%D0%B0%D0%BB%D1%8B%20%D0%BB%D0%B5%D0%BA%D1%86%D0%B8%D0%B9%20%D0%B8%20%D1%81%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%D0%BE%D0%B2/corpus_freq.xlsx) 

Таблица corst_freq 

![таблица 1](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/1.png). 

Таблица rlc_freq

![таблица 2](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/2.png)


Мы хотим получить общую таблицу, где данные из двух таблиц сведены вместе и их можно сравнить.

![14](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/14.png) 
### Внимание, в получившейся таблице могут и должны будут встречаться пустые ячейки!

## Что нужно делать:
**Шаг 1.**

Добавим в таблицу corst_freq столбец "Номер строки, на которой слово стоит в rlc_freq". 

![3](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/3.png)

**Шаг 2.**

Затем для каждого слова в таблице corst_freq нужно:
  * найти его в столбце "Слово" таблицы rlc_freq
  * определить номер строки, на которой он стоит
  * записать этот номер в столбец "Номер..." таблицы corst_freq

Чтобы в Excel выполнить эти три пункта, на вкладке Формулы найдем раздел "Ссылки и массивы" и в нем формулу "ПОИСКПОЗ" (в английской версии "MATCH"). 

![4](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/4.png)

В открывшемся окне вставки формул укажем:
  * Искомое_значение: кликните на ячейку с лексемой слева.
  * Просматриваемый массив: затем перейдите на лист таблицы rlc_freq и выделите столбец "Слово"
  * Тип сопоставления: 0 (обозначает точное совпадение).

Нажмите OK.

![5](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/5.png)

В ячейке должен отобразиться номер строки, на которой искомое слово стоит в таблице rlc_freq. Проверьте (с помощью поиска), что номер правильный.

Скопируем ячейку с формулой и вставим ее в том же столбце напротив всех остальных слов (можно дважды кликнуть на правый нижний угол заполненной ячейки, чтобы ее формула автоматически растянулась на весь столбец). 

![6](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/6.png)

**NB** Пересчет значений ячеек может занять некоторое время, особенно для больших таблиц.
Если после пересчета значений в каких-то ячейках появится #Н/Д (в английской версии - #N/A), это означает, что строка с таким словом не найдена.

**Шаг 3**

Добавим в таблицу corst_freq столбец "IPM_rlc". 

![7](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/7.png)

**Шаг 4**

На вкладке Формулы в разделе "Ссылки и массивы" найдем формулу "ИНДЕКС" (в английской версии "INDEX"), и в открывшемся мастере формулы:
   * выберите первую опцию

![8](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/8.png)

   * Массив: перейдите на лист rlc_freq и выделите столбец с IPM.
   * Номер_строки: поставьте курсор на поле "Номер..." в таблице corst_freq
   * Номер_столбца: оставьте пустым, так как мы работаем с одним столбцом.

![9](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/9.png)

Нажмите ОК.

Проверьте (с помощью поиска), что частота для данного слова указана правильно.
Скопируем ячейку с формулой и вставим ее напротив всех остальных слов.

![10](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/10.png)

Теперь мы переставили все найденные данные из таблицы rlc_freq. Осталось добавить те слова из rlc_freq, которых не нашлось в основной таблице.

**Шаг 5**

Теперь все будет наоборот: добавим в таблицу rlc_freq столбец "Номер строки, на которой слово стоит в corst_freq".

**Шаг 6**

Для каждого слова в таблице rlc_freq найдем его позицию в таблице corst_freq и запишем в столбце "Номер строки..." (так же, как в Шаге 2).

![11](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/11.png)

**Шаг 7**

Теперь мы хотим взять из таблицы rlc_freq только те слова, которых не нашлось в таблице corst_freq. 
Для этого отфильтруем все ячейки со значением "#Н/Д" в соответствующем столбце rlc_freq.

Делается это так:

  * Выделяем всю таблицу, нажав на ее левый верхний угол.
  * На вкладке "Данные" ищем функцию "Фильтр", нажимаем.
  * Выбираем нужную нам колонку "Номер строки, на которой слово стоит в rlc_freq", нажав на небольшую белую кнопку справа от ее названия.
  * Создаем и применяем фильтр с условием "равно..." и значением "#Н/Д" (или "equals" "#N/A" в англоязычном интерфейсе).
  * Готово, теперь у нас остались только нужные слова!
 
Если отфильтровать слова почему-то не удалось, можно попробовать отсортировать их по значению столбца "Номер строки, на которой слово стоит в rlc_freq". Так все слова со значением "#Н/Д" в этом столбце окажутся внизу или вверху таблицы, и их можно будет скопировать вручную.
  
![13](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/13.png)

Теперь добавим данные по этим словам в таблицу corst_freq (тут можно просто скопировать слова в столбец "Слова", а затем скопировать значения IPM в столбец "IPM_rlc").
_Примечание_: если вам не удается вставить скопировать слова на другую вкладку, значит, вы пытаетесь вставить содержание целого столца в часть другого столбца, что невозможно. Выделите именно диапазон ячеек от первого до последнего слова (и соответствующий диапазон частот).

**Шаг 8** 

Теперь у нас в таблице corst_freq сведены все данные! 

Давайте выделим нужные нам данные в отдельный лист. Создадим лист "merge", вставим туда колонки Слово, IPM_corst и IPM_rlc (используйте только вставку значений). В столбце IPM_rlc замените все вхождения #Н/Д на пустую строку. Укажите формат ячеек с IPM - числовой.

![14](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/14.png) 

Отсортируйте таблицу по столбцу "Слово", а затем по столбцу "IPM_corst".

**УРА!**

## Вопросы для проверки:
Ответы нужно писать в эту [форму](https://goo.gl/forms/rMQnG7v8mY6hmLtr2). 

1) Какие слова довольно частотны в RLC, но не встречаются в CORST? (приведите 6 самых частотных слов)

2) Какие слова, наоборот, частотны в CORST, но не встречаются в RLC? (приведите 6 самых частотных слов)

3) Различаются ли первые 10 слов в таблице, отсортированной по столбцу "IPM_corst" по убыванию, и в таблице, отсортированной по столбцу "IPM_rlc" по убыванию?

## Полезное

* частотный словарь НКРЯ (современный русский язык): http://dict.ruslang.ru/freq.php 

* видовые пары глаголов по Грамматическому словарю А.А.Зализняка: [таблица](https://github.com/pykili/pykili.github.io/blob/master/_docs/lingdata/AspectualPairZalizniak.xls) 

* база данных синонимов русского языка: http://web-corpora.net/synonyms

* другие ресурсы школы лингвистики: http://web-corpora.net/ и https://linghub.ru/
